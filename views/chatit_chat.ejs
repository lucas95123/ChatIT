<% include chatit_header.ejs %>
    <div class="container">
        <div class="row" style="margin-top:15px;">

            <!-- 聊天区 -->
            <div class="col-md-12">
                <!-- 聊天内容 -->
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <span class="glyphicon glyphicon-earphone"></span> &nbsp;李文勇
                    </div>
                    <div class="panel-body chat-body">
                        <ul id="messages" class="content-reply-box mg10">
                        </ul>
                        <form action="/chat">
                            <div class="col-bg-12">
                                <div class="form-group">
                                    <div class="input-group">
                                        <input id="m" type="text" class="form-control">
                                        <span class="input-group-btn"><button class="btn btn-default" type="submit">发送</button></span>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="javascripts/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
        var socket = io();
        $('form').submit(function() {
            $('#messages').append($("<li></li>")
                .attr("class", "even")
                .append($("<a></a>")
                    .attr("class", "user")
                    .append($("<img></img>")
                        .attr("class", "img-responsive avatar_")
                        .attr("src", "image/a.jpg")))
                .append($("<div></div>")
                    .attr("class", "reply-content-box")
                    .append($("<span></span>")
                        .attr("class", "reply-time")
                        .text("03-08 15：00"))
                    .append($("<div></div>")
                        .attr("class", "reply-content pr")
                        .append($("<span></span>")
                            .attr("class", "arrow"))
                        .text($('#m').val()))));
            socket.emit('chat message', $('#m').val());
            $('#m').val('');
            return false;
        });
        socket.on('chat message', function(msg) {
            $('#messages').append($("<li></li>")
                .attr("class", "odd")
                .append($("<a></a>")
                    .attr("class", "user")
                    .append($("<img></img>")
                        .attr("class", "img-responsive avatar_")
                        .attr("src", "image/a.jpg")))
                .append($("<div></div>")
                    .attr("class", "reply-content-box")
                    .append($("<span></span>")
                        .attr("class", "reply-time")
                        .text("03-08 15：00"))
                    .append($("<div></div>")
                        .attr("class", "reply-content pr")
                        .append($("<span></span>")
                            .attr("class", "arrow"))
                        .text(msg))));
        });
    </script>
    <!-- /container -->
